/**
 * 
 */
package com.liangshan.jianjian.android.preferences;

import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.content.res.Resources;
import android.util.Log;
import com.liangshan.jianjian.android.JianjianSettings;
import com.liangshan.jianjian.android.R;
import com.liangshan.jianjian.android.util.StringFormatters;
import com.liangshan.jianjian.types.User;

/**
 * @author jornel
 *
 */
public class JPreferences {
    
    private static final String TAG = "Preferences";
    private static final boolean DEBUG = JianjianSettings.DEBUG;
    
    
    public static final String PREFERENCE_STARTUP_TAB = "startup_tab";
    public static final String PREFERENCE_CACHE_GEOLOCATION_FOR_SEARCHES 
        = "cache_geolocation_for_searches";
    public static final String PREFERENCE_SHOW_PRELAUNCH_ACTIVITY = "show_prelaunch_activity";
    public static final String PREFERENCE_PINGS_INTERVAL = "pings_refresh_interval_in_minutes";
    public static final String PREFERENCE_NATIVE_IMAGE_VIEWER = "native_full_size_image_viewer";
    private static final String PREFERENCE_ID = null;
    private static final String PREFERENCE_USER_NAME = null;
    private static final String PREFERENCE_USER_EMAIL = null;
    private static final String PREFERENCE_GENDER = null;
    /**
     * @param preferences
     * @param resources
     */
    public static void setupDefaults(SharedPreferences preferences, Resources resources) {
        
        Editor editor = preferences.edit();
        if (!preferences.contains(PREFERENCE_STARTUP_TAB)) {
            String[] startupTabValues = resources.getStringArray(R.array.startup_tabs_values);
            editor.putString(PREFERENCE_STARTUP_TAB, startupTabValues[0]);
        }
        if (!preferences.contains(PREFERENCE_CACHE_GEOLOCATION_FOR_SEARCHES)) {
            editor.putBoolean(PREFERENCE_CACHE_GEOLOCATION_FOR_SEARCHES, false);
        }
        if (!preferences.contains(PREFERENCE_SHOW_PRELAUNCH_ACTIVITY)) {
            editor.putBoolean(PREFERENCE_SHOW_PRELAUNCH_ACTIVITY, true);
        }
        if (!preferences.contains(PREFERENCE_PINGS_INTERVAL)) {
            editor.putString(PREFERENCE_PINGS_INTERVAL, "30");
        }
        if (!preferences.contains(PREFERENCE_NATIVE_IMAGE_VIEWER)) {
            editor.putBoolean(PREFERENCE_NATIVE_IMAGE_VIEWER, true);
        }
        editor.commit();
    }
    
    public static void storeUser(final Editor editor, User user) {
        if (user != null && user.getUserid() != null) {
            editor.putString(PREFERENCE_ID, user.getUserid());
            editor.putString(PREFERENCE_USER_NAME, StringFormatters.getUserFullName(user));
            editor.putString(PREFERENCE_USER_EMAIL, user.getEmail());
            editor.putString(PREFERENCE_GENDER, user.getGender());
            if (DEBUG) Log.d(TAG, "Setting user info");
        } else {
            if (JPreferences.DEBUG) Log.d(JPreferences.TAG, "Unable to lookup user.");
        }
    }

}
